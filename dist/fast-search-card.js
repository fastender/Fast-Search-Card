(function(){"use strict";var U,h,_e,E,re,ne,oe,ie,B,O,G,T={},le=[],Ne=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,A=Array.isArray;function C(t,e){for(var _ in e)t[_]=e[_];return t}function K(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function Le(t,e,_){var n,i,o,a={};for(o in e)o=="key"?n=e[o]:o=="ref"?i=e[o]:a[o]=e[o];if(arguments.length>2&&(a.children=arguments.length>3?U.call(arguments,2):_),typeof t=="function"&&t.defaultProps!=null)for(o in t.defaultProps)a[o]===void 0&&(a[o]=t.defaultProps[o]);return D(t,a,n,i,null)}function D(t,e,_,n,i){var o={type:t,props:e,key:_,ref:n,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:i==null?++_e:i,__i:-1,__u:0};return i==null&&h.vnode!=null&&h.vnode(o),o}function F(t){return t.children}function M(t,e){this.props=t,this.context=e}function H(t,e){if(e==null)return t.__?H(t.__,t.__i+1):null;for(var _;e<t.__k.length;e++)if((_=t.__k[e])!=null&&_.__e!=null)return _.__e;return typeof t.type=="function"?H(t):null}function ae(t){var e,_;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((_=t.__k[e])!=null&&_.__e!=null){t.__e=t.__c.base=_.__e;break}return ae(t)}}function ce(t){(!t.__d&&(t.__d=!0)&&E.push(t)&&!W.__r++||re!=h.debounceRendering)&&((re=h.debounceRendering)||ne)(W)}function W(){for(var t,e,_,n,i,o,a,c=1;E.length;)E.length>c&&E.sort(oe),t=E.shift(),c=E.length,t.__d&&(_=void 0,i=(n=(e=t).__v).__e,o=[],a=[],e.__P&&((_=C({},n)).__v=n.__v+1,h.vnode&&h.vnode(_),V(e.__P,_,n,e.__n,e.__P.namespaceURI,32&n.__u?[i]:null,o,i==null?H(n):i,!!(32&n.__u),a),_.__v=n.__v,_.__.__k[_.__i]=_,fe(o,_,a),_.__e!=i&&ae(_)));W.__r=0}function se(t,e,_,n,i,o,a,c,d,l,p){var r,s,u,y,x,v,f,m=n&&n.__k||le,S=e.length;for(d=Ue(_,e,m,d,S),r=0;r<S;r++)(u=_.__k[r])!=null&&(s=u.__i==-1?T:m[u.__i]||T,u.__i=r,v=V(t,u,s,i,o,a,c,d,l,p),y=u.__e,u.ref&&s.ref!=u.ref&&(s.ref&&J(s.ref,null,u),p.push(u.ref,u.__c||y,u)),x==null&&y!=null&&(x=y),(f=!!(4&u.__u))||s.__k===u.__k?d=ue(u,d,t,f):typeof u.type=="function"&&v!==void 0?d=v:y&&(d=y.nextSibling),u.__u&=-7);return _.__e=x,d}function Ue(t,e,_,n,i){var o,a,c,d,l,p=_.length,r=p,s=0;for(t.__k=new Array(i),o=0;o<i;o++)(a=e[o])!=null&&typeof a!="boolean"&&typeof a!="function"?(d=o+s,(a=t.__k[o]=typeof a=="string"||typeof a=="number"||typeof a=="bigint"||a.constructor==String?D(null,a,null,null,null):A(a)?D(F,{children:a},null,null,null):a.constructor==null&&a.__b>0?D(a.type,a.props,a.key,a.ref?a.ref:null,a.__v):a).__=t,a.__b=t.__b+1,c=null,(l=a.__i=Ae(a,_,d,r))!=-1&&(r--,(c=_[l])&&(c.__u|=2)),c==null||c.__v==null?(l==-1&&(i>p?s--:i<p&&s++),typeof a.type!="function"&&(a.__u|=4)):l!=d&&(l==d-1?s--:l==d+1?s++:(l>d?s--:s++,a.__u|=4))):t.__k[o]=null;if(r)for(o=0;o<p;o++)(c=_[o])!=null&&(2&c.__u)==0&&(c.__e==n&&(n=H(c)),ve(c,c));return n}function ue(t,e,_,n){var i,o;if(typeof t.type=="function"){for(i=t.__k,o=0;i&&o<i.length;o++)i[o]&&(i[o].__=t,e=ue(i[o],e,_,n));return e}t.__e!=e&&(n&&(e&&t.type&&!e.parentNode&&(e=H(t)),_.insertBefore(t.__e,e||null)),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function Ae(t,e,_,n){var i,o,a,c=t.key,d=t.type,l=e[_],p=l!=null&&(2&l.__u)==0;if(l===null&&t.key==null||p&&c==l.key&&d==l.type)return _;if(n>(p?1:0)){for(i=_-1,o=_+1;i>=0||o<e.length;)if((l=e[a=i>=0?i--:o++])!=null&&(2&l.__u)==0&&c==l.key&&d==l.type)return a}return-1}function de(t,e,_){e[0]=="-"?t.setProperty(e,_==null?"":_):t[e]=_==null?"":typeof _!="number"||Ne.test(e)?_:_+"px"}function I(t,e,_,n,i){var o,a;e:if(e=="style")if(typeof _=="string")t.style.cssText=_;else{if(typeof n=="string"&&(t.style.cssText=n=""),n)for(e in n)_&&e in _||de(t.style,e,"");if(_)for(e in _)n&&_[e]==n[e]||de(t.style,e,_[e])}else if(e[0]=="o"&&e[1]=="n")o=e!=(e=e.replace(ie,"$1")),a=e.toLowerCase(),e=a in t||e=="onFocusOut"||e=="onFocusIn"?a.slice(2):e.slice(2),t.l||(t.l={}),t.l[e+o]=_,_?n?_.u=n.u:(_.u=B,t.addEventListener(e,o?G:O,o)):t.removeEventListener(e,o?G:O,o);else{if(i=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=_==null?"":_;break e}catch{}typeof _=="function"||(_==null||_===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&_==1?"":_))}}function pe(t){return function(e){if(this.l){var _=this.l[e.type+t];if(e.t==null)e.t=B++;else if(e.t<_.u)return;return _(h.event?h.event(e):e)}}}function V(t,e,_,n,i,o,a,c,d,l){var p,r,s,u,y,x,v,f,m,S,$,j,N,Te,q,L,te,w=e.type;if(e.constructor!=null)return null;128&_.__u&&(d=!!(32&_.__u),o=[c=e.__e=_.__e]),(p=h.__b)&&p(e);e:if(typeof w=="function")try{if(f=e.props,m="prototype"in w&&w.prototype.render,S=(p=w.contextType)&&n[p.__c],$=p?S?S.props.value:p.__:n,_.__c?v=(r=e.__c=_.__c).__=r.__E:(m?e.__c=r=new w(f,$):(e.__c=r=new M(f,$),r.constructor=w,r.render=Fe),S&&S.sub(r),r.props=f,r.state||(r.state={}),r.context=$,r.__n=n,s=r.__d=!0,r.__h=[],r._sb=[]),m&&r.__s==null&&(r.__s=r.state),m&&w.getDerivedStateFromProps!=null&&(r.__s==r.state&&(r.__s=C({},r.__s)),C(r.__s,w.getDerivedStateFromProps(f,r.__s))),u=r.props,y=r.state,r.__v=e,s)m&&w.getDerivedStateFromProps==null&&r.componentWillMount!=null&&r.componentWillMount(),m&&r.componentDidMount!=null&&r.__h.push(r.componentDidMount);else{if(m&&w.getDerivedStateFromProps==null&&f!==u&&r.componentWillReceiveProps!=null&&r.componentWillReceiveProps(f,$),!r.__e&&r.shouldComponentUpdate!=null&&r.shouldComponentUpdate(f,r.__s,$)===!1||e.__v==_.__v){for(e.__v!=_.__v&&(r.props=f,r.state=r.__s,r.__d=!1),e.__e=_.__e,e.__k=_.__k,e.__k.some(function(P){P&&(P.__=e)}),j=0;j<r._sb.length;j++)r.__h.push(r._sb[j]);r._sb=[],r.__h.length&&a.push(r);break e}r.componentWillUpdate!=null&&r.componentWillUpdate(f,r.__s,$),m&&r.componentDidUpdate!=null&&r.__h.push(function(){r.componentDidUpdate(u,y,x)})}if(r.context=$,r.props=f,r.__P=t,r.__e=!1,N=h.__r,Te=0,m){for(r.state=r.__s,r.__d=!1,N&&N(e),p=r.render(r.props,r.state,r.context),q=0;q<r._sb.length;q++)r.__h.push(r._sb[q]);r._sb=[]}else do r.__d=!1,N&&N(e),p=r.render(r.props,r.state,r.context),r.state=r.__s;while(r.__d&&++Te<25);r.state=r.__s,r.getChildContext!=null&&(n=C(C({},n),r.getChildContext())),m&&!s&&r.getSnapshotBeforeUpdate!=null&&(x=r.getSnapshotBeforeUpdate(u,y)),L=p,p!=null&&p.type===F&&p.key==null&&(L=he(p.props.children)),c=se(t,A(L)?L:[L],e,_,n,i,o,a,c,d,l),r.base=e.__e,e.__u&=-161,r.__h.length&&a.push(r),v&&(r.__E=r.__=null)}catch(P){if(e.__v=null,d||o!=null)if(P.then){for(e.__u|=d?160:128;c&&c.nodeType==8&&c.nextSibling;)c=c.nextSibling;o[o.indexOf(c)]=null,e.__e=c}else{for(te=o.length;te--;)K(o[te]);Q(e)}else e.__e=_.__e,e.__k=_.__k,P.then||Q(e);h.__e(P,e,_)}else o==null&&e.__v==_.__v?(e.__k=_.__k,e.__e=_.__e):c=e.__e=De(_.__e,e,_,n,i,o,a,d,l);return(p=h.diffed)&&p(e),128&e.__u?void 0:c}function Q(t){t&&t.__c&&(t.__c.__e=!0),t&&t.__k&&t.__k.forEach(Q)}function fe(t,e,_){for(var n=0;n<_.length;n++)J(_[n],_[++n],_[++n]);h.__c&&h.__c(e,t),t.some(function(i){try{t=i.__h,i.__h=[],t.some(function(o){o.call(i)})}catch(o){h.__e(o,i.__v)}})}function he(t){return typeof t!="object"||t==null||t.__b&&t.__b>0?t:A(t)?t.map(he):C({},t)}function De(t,e,_,n,i,o,a,c,d){var l,p,r,s,u,y,x,v=_.props,f=e.props,m=e.type;if(m=="svg"?i="http://www.w3.org/2000/svg":m=="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),o!=null){for(l=0;l<o.length;l++)if((u=o[l])&&"setAttribute"in u==!!m&&(m?u.localName==m:u.nodeType==3)){t=u,o[l]=null;break}}if(t==null){if(m==null)return document.createTextNode(f);t=document.createElementNS(i,m,f.is&&f),c&&(h.__m&&h.__m(e,o),c=!1),o=null}if(m==null)v===f||c&&t.data==f||(t.data=f);else{if(o=o&&U.call(t.childNodes),v=_.props||T,!c&&o!=null)for(v={},l=0;l<t.attributes.length;l++)v[(u=t.attributes[l]).name]=u.value;for(l in v)if(u=v[l],l!="children"){if(l=="dangerouslySetInnerHTML")r=u;else if(!(l in f)){if(l=="value"&&"defaultValue"in f||l=="checked"&&"defaultChecked"in f)continue;I(t,l,null,u,i)}}for(l in f)u=f[l],l=="children"?s=u:l=="dangerouslySetInnerHTML"?p=u:l=="value"?y=u:l=="checked"?x=u:c&&typeof u!="function"||v[l]===u||I(t,l,u,v[l],i);if(p)c||r&&(p.__html==r.__html||p.__html==t.innerHTML)||(t.innerHTML=p.__html),e.__k=[];else if(r&&(t.innerHTML=""),se(e.type=="template"?t.content:t,A(s)?s:[s],e,_,n,m=="foreignObject"?"http://www.w3.org/1999/xhtml":i,o,a,o?o[0]:_.__k&&H(_,0),c,d),o!=null)for(l=o.length;l--;)K(o[l]);c||(l="value",m=="progress"&&y==null?t.removeAttribute("value"):y!=null&&(y!==t[l]||m=="progress"&&!y||m=="option"&&y!=v[l])&&I(t,l,y,v[l],i),l="checked",x!=null&&x!=t[l]&&I(t,l,x,v[l],i))}return t}function J(t,e,_){try{if(typeof t=="function"){var n=typeof t.__u=="function";n&&t.__u(),n&&e==null||(t.__u=t(e))}else t.current=e}catch(i){h.__e(i,_)}}function ve(t,e,_){var n,i;if(h.unmount&&h.unmount(t),(n=t.ref)&&(n.current&&n.current!=t.__e||J(n,null,e)),(n=t.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(o){h.__e(o,e)}n.base=n.__P=null}if(n=t.__k)for(i=0;i<n.length;i++)n[i]&&ve(n[i],e,_||typeof t.type!="function");_||K(t.__e),t.__c=t.__=t.__e=void 0}function Fe(t,e,_){return this.constructor(t,_)}function me(t,e,_){var n,i,o,a;e==document&&(e=document.documentElement),h.__&&h.__(t,e),i=(n=!1)?null:e.__k,o=[],a=[],V(e,t=e.__k=Le(F,null,[t]),i||T,T,e.namespaceURI,i?null:e.firstChild?U.call(e.childNodes):null,o,i?i.__e:e.firstChild,n,a),fe(o,t,a)}U=le.slice,h={__e:function(t,e,_,n){for(var i,o,a;e=e.__;)if((i=e.__c)&&!i.__)try{if((o=i.constructor)&&o.getDerivedStateFromError!=null&&(i.setState(o.getDerivedStateFromError(t)),a=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(t,n||{}),a=i.__d),a)return i.__E=i}catch(c){t=c}throw t}},_e=0,M.prototype.setState=function(t,e){var _;_=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=C({},this.state),typeof t=="function"&&(t=t(C({},_),this.props)),t&&C(_,t),t!=null&&this.__v&&(e&&this._sb.push(e),ce(this))},M.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),ce(this))},M.prototype.render=F,E=[],ne=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,oe=function(t,e){return t.__v.__b-e.__v.__b},W.__r=0,ie=/(PointerCapture)$|Capture$/i,B=0,O=pe(!1),G=pe(!0);var Me=0;function k(t,e,_,n,i,o){e||(e={});var a,c,d=e;if("ref"in d)for(c in d={},e)c=="ref"?a=e[c]:d[c]=e[c];var l={type:t,props:d,key:_,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Me,__i:-1,__u:0,__source:i,__self:o};if(typeof t=="function"&&(a=t.defaultProps))for(c in a)d[c]===void 0&&(d[c]=a[c]);return h.vnode&&h.vnode(l),l}var z,g,X,ye,Y=0,ge=[],b=h,be=b.__b,ke=b.__r,xe=b.diffed,we=b.__c,Ce=b.unmount,Se=b.__;function $e(t,e){b.__h&&b.__h(g,t,Y||e),Y=0;var _=g.__H||(g.__H={__:[],__h:[]});return t>=_.__.length&&_.__.push({}),_.__[t]}function Ee(t){return Y=1,We(Pe,t)}function We(t,e,_){var n=$e(z++,2);if(n.t=t,!n.__c&&(n.__=[Pe(void 0,e),function(c){var d=n.__N?n.__N[0]:n.__[0],l=n.t(d,c);d!==l&&(n.__N=[l,n.__[1]],n.__c.setState({}))}],n.__c=g,!g.__f)){var i=function(c,d,l){if(!n.__c.__H)return!0;var p=n.__c.__H.__.filter(function(s){return!!s.__c});if(p.every(function(s){return!s.__N}))return!o||o.call(this,c,d,l);var r=n.__c.props!==c;return p.forEach(function(s){if(s.__N){var u=s.__[0];s.__=s.__N,s.__N=void 0,u!==s.__[0]&&(r=!0)}}),o&&o.call(this,c,d,l)||r};g.__f=!0;var o=g.shouldComponentUpdate,a=g.componentWillUpdate;g.componentWillUpdate=function(c,d,l){if(this.__e){var p=o;o=void 0,i(c,d,l),o=p}a&&a.call(this,c,d,l)},g.shouldComponentUpdate=i}return n.__N||n.__}function Z(t,e){var _=$e(z++,7);return Re(_.__H,e)&&(_.__=t(),_.__H=e,_.__h=t),_.__}function Ie(){for(var t;t=ge.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(R),t.__H.__h.forEach(ee),t.__H.__h=[]}catch(e){t.__H.__h=[],b.__e(e,t.__v)}}b.__b=function(t){g=null,be&&be(t)},b.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),Se&&Se(t,e)},b.__r=function(t){ke&&ke(t),z=0;var e=(g=t.__c).__H;e&&(X===g?(e.__h=[],g.__h=[],e.__.forEach(function(_){_.__N&&(_.__=_.__N),_.u=_.__N=void 0})):(e.__h.forEach(R),e.__h.forEach(ee),e.__h=[],z=0)),X=g},b.diffed=function(t){xe&&xe(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(ge.push(e)!==1&&ye===b.requestAnimationFrame||((ye=b.requestAnimationFrame)||ze)(Ie)),e.__H.__.forEach(function(_){_.u&&(_.__H=_.u),_.u=void 0})),X=g=null},b.__c=function(t,e){e.some(function(_){try{_.__h.forEach(R),_.__h=_.__h.filter(function(n){return!n.__||ee(n)})}catch(n){e.some(function(i){i.__h&&(i.__h=[])}),e=[],b.__e(n,_.__v)}}),we&&we(t,e)},b.unmount=function(t){Ce&&Ce(t);var e,_=t.__c;_&&_.__H&&(_.__H.__.forEach(function(n){try{R(n)}catch(i){e=i}}),_.__H=void 0,e&&b.__e(e,_.__v))};var He=typeof requestAnimationFrame=="function";function ze(t){var e,_=function(){clearTimeout(n),He&&cancelAnimationFrame(e),setTimeout(t)},n=setTimeout(_,35);He&&(e=requestAnimationFrame(_))}function R(t){var e=g,_=t.__c;typeof _=="function"&&(t.__c=void 0,_()),g=e}function ee(t){var e=g;t.__c=t.__(),g=e}function Re(t,e){return!t||t.length!==e.length||e.some(function(_,n){return _!==t[n]})}function Pe(t,e){return typeof e=="function"?e(t):e}function je({hass:t,config:e,host:_}){const[n,i]=Ee(""),[o,a]=Ee("all"),c=Z(()=>{const s=(t==null?void 0:t.states)||{};return Object.values(s).map(u=>{const y=u.entity_id,x=u.attributes.friendly_name||y,v=u.attributes.area||"",f=y.split(".")[0];return{id:y,name:x,nameLc:x.toLowerCase(),area:v,areaLc:v.toLowerCase(),domain:f,state:u.state,isAvailable:u.state!=="unavailable"}})},[t==null?void 0:t.states]),d=Z(()=>{const s=new Set(["all"]);for(const u of c)s.add(u.domain);return[...s]},[c]),l=Z(()=>{var x;let s=c;o!=="all"&&(s=s.filter(v=>v.domain===o));const u=n.trim().toLowerCase();u&&(s=s.filter(v=>{var f;return v.nameLc.includes(u)||v.id.includes(u)||((f=v.areaLc)==null?void 0:f.includes(u))}));const y=Number((x=e==null?void 0:e.max_results)!=null?x:60);return s.slice(0,y)},[c,o,n,e==null?void 0:e.max_results]),p=s=>{var u;return(u=t==null?void 0:t.callService)==null?void 0:u.call(t,"homeassistant","toggle",{entity_id:s})},r=s=>{_&&_.dispatchEvent(new CustomEvent("hass-more-info",{detail:{entityId:s},bubbles:!0,composed:!0}))};return k("div",{style:"padding:12px; display:grid; gap:10px;",children:[k("div",{style:"display:grid; grid-template-columns: 1fr auto; gap:10px;",children:[k("input",{type:"search",placeholder:"Geräte suchen…",value:n,onInput:s=>i(s.currentTarget.value),style:"padding:8px 10px; border-radius:10px; border:1px solid var(--divider-color); background:var(--card-background-color); color:var(--primary-text-color);","aria-label":"Gerätesuche"}),k("select",{value:o,onChange:s=>a(s.currentTarget.value),style:"padding:8px 10px; border-radius:10px; border:1px solid var(--divider-color); background:var(--card-background-color); color:var(--primary-text-color);","aria-label":"Kategorie",children:d.map(s=>k("option",{value:s,children:s},s))})]}),k("div",{style:"opacity:.7; font-size:.9em;",children:["Treffer: ",l.length," / ",c.length]}),k("div",{style:"display:grid; gap:10px; grid-template-columns: repeat(auto-fill, minmax(240px,1fr));",role:"list",children:[l.map(s=>k("div",{role:"listitem",style:"border:1px solid var(--divider-color); border-radius:12px; background:var(--card-background-color); padding:10px; display:grid; gap:8px; align-content:start;",children:[k("div",{style:"font-weight:600;",children:s.name}),k("div",{style:"opacity:.7; font-size:.9em;",children:[s.domain," · ",s.state," · ",k("code",{style:"opacity:.8",children:s.id})]}),k("div",{style:"display:flex; gap:8px;",children:[k("button",{onClick:()=>p(s.id),style:"padding:6px 10px; border-radius:8px; border:1px solid var(--divider-color); background:transparent; cursor:pointer;",title:"Umschalten",children:"Umschalten"}),k("button",{onClick:()=>r(s.id),style:"padding:6px 10px; border-radius:8px; border:1px solid var(--divider-color); background:transparent; cursor:pointer;",title:"Details",children:"Details"})]}),!s.isAvailable&&k("div",{style:"opacity:.7; font-size:.85em;",children:"(nicht verfügbar)"})]},s.id)),l.length===0&&k("div",{style:"opacity:.7;",children:"Keine Treffer."})]})]})}const qe=`:host { display:block; color: var(--primary-text-color); }
`;class Be extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this._mount=document.createElement("div");const e=document.createElement("style");e.textContent=qe,this.shadowRoot.append(e,this._mount)}setConfig(e){this._config=e||{},this._render()}set hass(e){this._hass=e,this._render()}connectedCallback(){this._render()}disconnectedCallback(){me(null,this._mount)}_render(){this._mount&&me(k(je,{hass:this._hass,config:this._config,host:this}),this._mount)}static getStubConfig(){return{type:"custom:fast-search-card",title:"Search"}}getCardSize(){return 4}}customElements.get("fast-search-card")||customElements.define("fast-search-card",Be),window.customCards=window.customCards||[],window.customCards.find(t=>t.type==="fast-search-card")||window.customCards.push({type:"fast-search-card",name:"Fast Search Card",preview:!0,description:"Single-file Preact card"})})();
