!function(){"use strict";var e,t,n,r,i,o,s,a,c,u,l,_,d={},h=[],f=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,p=Array.isArray;function v(e,t){for(var n in t)e[n]=t[n];return e}function m(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function g(t,n,r){var i,o,s,a={};for(s in n)"key"==s?i=n[s]:"ref"==s?o=n[s]:a[s]=n[s];if(arguments.length>2&&(a.children=arguments.length>3?e.call(arguments,2):r),"function"==typeof t&&null!=t.defaultProps)for(s in t.defaultProps)void 0===a[s]&&(a[s]=t.defaultProps[s]);return y(t,a,i,o,null)}function y(e,r,i,o,s){var a={type:e,props:r,key:i,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:null==s?++n:s,__i:-1,__u:0};return null==s&&null!=t.vnode&&t.vnode(a),a}function b(){return{current:null}}function C(e){return e.children}function A(e,t){this.props=e,this.context=t}function E(e,t){if(null==t)return e.__?E(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?E(e):null}function w(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return w(e)}}function S(e){(!e.__d&&(e.__d=!0)&&r.push(e)&&!k.__r++||i!=t.debounceRendering)&&((i=t.debounceRendering)||o)(k)}function k(){for(var e,n,i,o,a,c,u,l=1;r.length;)r.length>l&&r.sort(s),e=r.shift(),l=r.length,e.__d&&(i=void 0,a=(o=(n=e).__v).__e,c=[],u=[],n.__P&&((i=v({},o)).__v=o.__v+1,t.vnode&&t.vnode(i),I(n.__P,i,o,n.__n,n.__P.namespaceURI,32&o.__u?[a]:null,c,null==a?E(o):a,!!(32&o.__u),u),i.__v=o.__v,i.__.__k[i.__i]=i,R(c,i,u),i.__e!=a&&w(i)));k.__r=0}function x(e,t,n,r,i,o,s,a,c,u,l){var _,f,v,m,g,b,A,w=r&&r.__k||h,S=t.length;for(c=function(e,t,n,r,i){var o,s,a,c,u,l=n.length,_=l,d=0;for(e.__k=new Array(i),o=0;o<i;o++)null!=(s=t[o])&&"boolean"!=typeof s&&"function"!=typeof s?(c=o+d,(s=e.__k[o]="string"==typeof s||"number"==typeof s||"bigint"==typeof s||s.constructor==String?y(null,s,null,null,null):p(s)?y(C,{children:s},null,null,null):null==s.constructor&&s.__b>0?y(s.type,s.props,s.key,s.ref?s.ref:null,s.__v):s).__=e,s.__b=e.__b+1,a=null,-1!=(u=s.__i=D(s,n,c,_))&&(_--,(a=n[u])&&(a.__u|=2)),null==a||null==a.__v?(-1==u&&(i>l?d--:i<l&&d++),"function"!=typeof s.type&&(s.__u|=4)):u!=c&&(u==c-1?d--:u==c+1?d++:(u>c?d--:d++,s.__u|=4))):e.__k[o]=null;if(_)for(o=0;o<l;o++)null!=(a=n[o])&&!(2&a.__u)&&(a.__e==r&&(r=E(a)),$(a,a));return r}(n,t,w,c,S),_=0;_<S;_++)null!=(v=n.__k[_])&&(f=-1==v.__i?d:w[v.__i]||d,v.__i=_,b=I(e,v,f,i,o,s,a,c,u,l),m=v.__e,v.ref&&f.ref!=v.ref&&(f.ref&&T(f.ref,null,v),l.push(v.ref,v.__c||m,v)),null==g&&null!=m&&(g=m),(A=!!(4&v.__u))||f.__k===v.__k?c=F(v,c,e,A):"function"==typeof v.type&&void 0!==b?c=b:m&&(c=m.nextSibling),v.__u&=-7);return n.__e=g,c}function F(e,t,n,r){var i,o;if("function"==typeof e.type){for(i=e.__k,o=0;i&&o<i.length;o++)i[o]&&(i[o].__=e,t=F(i[o],t,n,r));return t}e.__e!=t&&(r&&(t&&e.type&&!t.parentNode&&(t=E(e)),n.insertBefore(e.__e,t||null)),t=e.__e);do{t=t&&t.nextSibling}while(null!=t&&8==t.nodeType);return t}function M(e,t){return t=t||[],null==e||"boolean"==typeof e||(p(e)?e.some(function(e){M(e,t)}):t.push(e)),t}function D(e,t,n,r){var i,o,s,a=e.key,c=e.type,u=t[n],l=null!=u&&!(2&u.__u);if(null===u&&null==e.key||l&&a==u.key&&c==u.type)return n;if(r>(l?1:0))for(i=n-1,o=n+1;i>=0||o<t.length;)if(null!=(u=t[s=i>=0?i--:o++])&&!(2&u.__u)&&a==u.key&&c==u.type)return s;return-1}function N(e,t,n){"-"==t[0]?e.setProperty(t,null==n?"":n):e[t]=null==n?"":"number"!=typeof n||f.test(t)?n:n+"px"}function B(e,t,n,r,i){var o,s;e:if("style"==t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof r&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||N(e.style,t,"");if(n)for(t in n)r&&n[t]==r[t]||N(e.style,t,n[t])}else if("o"==t[0]&&"n"==t[1])o=t!=(t=t.replace(a,"$1")),s=t.toLowerCase(),t=s in e||"onFocusOut"==t||"onFocusIn"==t?s.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+o]=n,n?r?n.u=r.u:(n.u=c,e.addEventListener(t,o?l:u,o)):e.removeEventListener(t,o?l:u,o);else{if("http://www.w3.org/2000/svg"==i)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!=t&&"height"!=t&&"href"!=t&&"list"!=t&&"form"!=t&&"tabIndex"!=t&&"download"!=t&&"rowSpan"!=t&&"colSpan"!=t&&"role"!=t&&"popover"!=t&&t in e)try{e[t]=null==n?"":n;break e}catch(_){}"function"==typeof n||(null==n||!1===n&&"-"!=t[4]?e.removeAttribute(t):e.setAttribute(t,"popover"==t&&1==n?"":n))}}function L(e){return function(n){if(this.l){var r=this.l[n.type+e];if(null==n.t)n.t=c++;else if(n.t<r.u)return;return r(t.event?t.event(n):n)}}}function I(n,r,i,o,s,a,c,u,l,_){var h,f,g,y,b,w,S,k,F,M,D,N,L,I,R,T,$,H=r.type;if(null!=r.constructor)return null;128&i.__u&&(l=!!(32&i.__u),a=[u=r.__e=i.__e]),(h=t.__b)&&h(r);e:if("function"==typeof H)try{if(k=r.props,F="prototype"in H&&H.prototype.render,M=(h=H.contextType)&&o[h.__c],D=h?M?M.props.value:h.__:o,i.__c?S=(f=r.__c=i.__c).__=f.__E:(F?r.__c=f=new H(k,D):(r.__c=f=new A(k,D),f.constructor=H,f.render=U),M&&M.sub(f),f.props=k,f.state||(f.state={}),f.context=D,f.__n=o,g=f.__d=!0,f.__h=[],f._sb=[]),F&&null==f.__s&&(f.__s=f.state),F&&null!=H.getDerivedStateFromProps&&(f.__s==f.state&&(f.__s=v({},f.__s)),v(f.__s,H.getDerivedStateFromProps(k,f.__s))),y=f.props,b=f.state,f.__v=r,g)F&&null==H.getDerivedStateFromProps&&null!=f.componentWillMount&&f.componentWillMount(),F&&null!=f.componentDidMount&&f.__h.push(f.componentDidMount);else{if(F&&null==H.getDerivedStateFromProps&&k!==y&&null!=f.componentWillReceiveProps&&f.componentWillReceiveProps(k,D),!f.__e&&null!=f.shouldComponentUpdate&&!1===f.shouldComponentUpdate(k,f.__s,D)||r.__v==i.__v){for(r.__v!=i.__v&&(f.props=k,f.state=f.__s,f.__d=!1),r.__e=i.__e,r.__k=i.__k,r.__k.some(function(e){e&&(e.__=r)}),N=0;N<f._sb.length;N++)f.__h.push(f._sb[N]);f._sb=[],f.__h.length&&c.push(f);break e}null!=f.componentWillUpdate&&f.componentWillUpdate(k,f.__s,D),F&&null!=f.componentDidUpdate&&f.__h.push(function(){f.componentDidUpdate(y,b,w)})}if(f.context=D,f.props=k,f.__P=n,f.__e=!1,L=t.__r,I=0,F){for(f.state=f.__s,f.__d=!1,L&&L(r),h=f.render(f.props,f.state,f.context),R=0;R<f._sb.length;R++)f.__h.push(f._sb[R]);f._sb=[]}else do{f.__d=!1,L&&L(r),h=f.render(f.props,f.state,f.context),f.state=f.__s}while(f.__d&&++I<25);f.state=f.__s,null!=f.getChildContext&&(o=v(v({},o),f.getChildContext())),F&&!g&&null!=f.getSnapshotBeforeUpdate&&(w=f.getSnapshotBeforeUpdate(y,b)),T=h,null!=h&&h.type===C&&null==h.key&&(T=P(h.props.children)),u=x(n,p(T)?T:[T],r,i,o,s,a,c,u,l,_),f.base=r.__e,r.__u&=-161,f.__h.length&&c.push(f),S&&(f.__E=f.__=null)}catch(W){if(r.__v=null,l||null!=a)if(W.then){for(r.__u|=l?160:128;u&&8==u.nodeType&&u.nextSibling;)u=u.nextSibling;a[a.indexOf(u)]=null,r.__e=u}else{for($=a.length;$--;)m(a[$]);O(r)}else r.__e=i.__e,r.__k=i.__k,W.then||O(r);t.__e(W,r,i)}else null==a&&r.__v==i.__v?(r.__k=i.__k,r.__e=i.__e):u=r.__e=function(n,r,i,o,s,a,c,u,l){var _,h,f,v,g,y,b,C=i.props,A=r.props,w=r.type;if("svg"==w?s="http://www.w3.org/2000/svg":"math"==w?s="http://www.w3.org/1998/Math/MathML":s||(s="http://www.w3.org/1999/xhtml"),null!=a)for(_=0;_<a.length;_++)if((g=a[_])&&"setAttribute"in g==!!w&&(w?g.localName==w:3==g.nodeType)){n=g,a[_]=null;break}if(null==n){if(null==w)return document.createTextNode(A);n=document.createElementNS(s,w,A.is&&A),u&&(t.__m&&t.__m(r,a),u=!1),a=null}if(null==w)C===A||u&&n.data==A||(n.data=A);else{if(a=a&&e.call(n.childNodes),C=i.props||d,!u&&null!=a)for(C={},_=0;_<n.attributes.length;_++)C[(g=n.attributes[_]).name]=g.value;for(_ in C)if(g=C[_],"children"==_);else if("dangerouslySetInnerHTML"==_)f=g;else if(!(_ in A)){if("value"==_&&"defaultValue"in A||"checked"==_&&"defaultChecked"in A)continue;B(n,_,null,g,s)}for(_ in A)g=A[_],"children"==_?v=g:"dangerouslySetInnerHTML"==_?h=g:"value"==_?y=g:"checked"==_?b=g:u&&"function"!=typeof g||C[_]===g||B(n,_,g,C[_],s);if(h)u||f&&(h.__html==f.__html||h.__html==n.innerHTML)||(n.innerHTML=h.__html),r.__k=[];else if(f&&(n.innerHTML=""),x("template"==r.type?n.content:n,p(v)?v:[v],r,i,o,"foreignObject"==w?"http://www.w3.org/1999/xhtml":s,a,c,a?a[0]:i.__k&&E(i,0),u,l),null!=a)for(_=a.length;_--;)m(a[_]);u||(_="value","progress"==w&&null==y?n.removeAttribute("value"):null!=y&&(y!==n[_]||"progress"==w&&!y||"option"==w&&y!=C[_])&&B(n,_,y,C[_],s),_="checked",null!=b&&b!=n[_]&&B(n,_,b,C[_],s))}return n}(i.__e,r,i,o,s,a,c,l,_);return(h=t.diffed)&&h(r),128&r.__u?void 0:u}function O(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(O)}function R(e,n,r){for(var i=0;i<r.length;i++)T(r[i],r[++i],r[++i]);t.__c&&t.__c(n,e),e.some(function(n){try{e=n.__h,n.__h=[],e.some(function(e){e.call(n)})}catch(r){t.__e(r,n.__v)}})}function P(e){return"object"!=typeof e||null==e||e.__b&&e.__b>0?e:p(e)?e.map(P):v({},e)}function T(e,n,r){try{if("function"==typeof e){var i="function"==typeof e.__u;i&&e.__u(),i&&null==n||(e.__u=e(n))}else e.current=n}catch(o){t.__e(o,r)}}function $(e,n,r){var i,o;if(t.unmount&&t.unmount(e),(i=e.ref)&&(i.current&&i.current!=e.__e||T(i,null,n)),null!=(i=e.__c)){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(s){t.__e(s,n)}i.base=i.__P=null}if(i=e.__k)for(o=0;o<i.length;o++)i[o]&&$(i[o],n,r||"function"!=typeof e.type);r||m(e.__e),e.__c=e.__=e.__e=void 0}function U(e,t,n){return this.constructor(e,n)}function H(n,r,i){var o,s,a,c;r==document&&(r=document.documentElement),t.__&&t.__(n,r),s=(o="function"==typeof i)?null:i&&i.__k||r.__k,a=[],c=[],I(r,n=(!o&&i||r).__k=g(C,null,[n]),s||d,d,r.namespaceURI,!o&&i?[i]:s?null:r.firstChild?e.call(r.childNodes):null,a,!o&&i?i:s?s.__e:r.firstChild,o,c),R(a,n,c)}function W(e,t){H(e,t,W)}function j(t,n,r){var i,o,s,a,c=v({},t.props);for(s in t.type&&t.type.defaultProps&&(a=t.type.defaultProps),n)"key"==s?i=n[s]:"ref"==s?o=n[s]:c[s]=void 0===n[s]&&null!=a?a[s]:n[s];return arguments.length>2&&(c.children=arguments.length>3?e.call(arguments,2):r),y(t.type,c,i||t.key,o||t.ref,null)}function V(e){function t(e){var n,r;return this.getChildContext||(n=new Set,(r={})[t.__c]=this,this.getChildContext=function(){return r},this.componentWillUnmount=function(){n=null},this.shouldComponentUpdate=function(e){this.props.value!=e.value&&n.forEach(function(e){e.__e=!0,S(e)})},this.sub=function(e){n.add(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){n&&n.delete(e),t&&t.call(e)}}),e.children}return t.__c="__cC"+_++,t.__=e,t.Provider=t.__l=(t.Consumer=function(e,t){return e.children(t)}).contextType=t,t}e=h.slice,t={__e:function(e,t,n,r){for(var i,o,s;t=t.__;)if((i=t.__c)&&!i.__)try{if((o=i.constructor)&&null!=o.getDerivedStateFromError&&(i.setState(o.getDerivedStateFromError(e)),s=i.__d),null!=i.componentDidCatch&&(i.componentDidCatch(e,r||{}),s=i.__d),s)return i.__E=i}catch(a){e=a}throw e}},n=0,A.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!=this.state?this.__s:this.__s=v({},this.state),"function"==typeof e&&(e=e(v({},n),this.props)),e&&v(n,e),null!=e&&this.__v&&(t&&this._sb.push(t),S(this))},A.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),S(this))},A.prototype.render=C,r=[],o="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,s=function(e,t){return e.__v.__b-t.__v.__b},k.__r=0,a=/(PointerCapture)$|Capture$/i,c=0,u=L(!1),l=L(!0),_=0;var z=0;function Q(e,n,r,i,o,s){n||(n={});var a,c,u=n;if("ref"in u)for(c in u={},n)"ref"==c?a=n[c]:u[c]=n[c];var l={type:e,props:u,key:r,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--z,__i:-1,__u:0,__source:o,__self:s};if("function"==typeof e&&(a=e.defaultProps))for(c in a)void 0===u[c]&&(u[c]=a[c]);return t.vnode&&t.vnode(l),l}var q,J,G,K,Y=0,Z=[],X=t,ee=X.__b,te=X.__r,ne=X.diffed,re=X.__c,ie=X.unmount,oe=X.__;function se(e,t){X.__h&&X.__h(J,e,Y||t),Y=0;var n=J.__H||(J.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function ae(e){return Y=1,ce(we,e)}function ce(e,t,n){var r=se(q++,2);if(r.t=e,!r.__c&&(r.__=[n?n(t):we(void 0,t),function(e){var t=r.__N?r.__N[0]:r.__[0],n=r.t(t,e);t!==n&&(r.__N=[n,r.__[1]],r.__c.setState({}))}],r.__c=J,!J.__f)){var i=function(e,t,n){if(!r.__c.__H)return!0;var i=r.__c.__H.__.filter(function(e){return!!e.__c});if(i.every(function(e){return!e.__N}))return!o||o.call(this,e,t,n);var s=r.__c.props!==e;return i.forEach(function(e){if(e.__N){var t=e.__[0];e.__=e.__N,e.__N=void 0,t!==e.__[0]&&(s=!0)}}),o&&o.call(this,e,t,n)||s};J.__f=!0;var o=J.shouldComponentUpdate,s=J.componentWillUpdate;J.componentWillUpdate=function(e,t,n){if(this.__e){var r=o;o=void 0,i(e,t,n),o=r}s&&s.call(this,e,t,n)},J.shouldComponentUpdate=i}return r.__N||r.__}function ue(e,t){var n=se(q++,3);!X.__s&&Ee(n.__H,t)&&(n.__=e,n.u=t,J.__H.__h.push(n))}function le(e,t){var n=se(q++,4);!X.__s&&Ee(n.__H,t)&&(n.__=e,n.u=t,J.__h.push(n))}function _e(e){return Y=5,he(function(){return{current:e}},[])}function de(e,t,n){Y=6,le(function(){if("function"==typeof e){var n=e(t());return function(){e(null),n&&"function"==typeof n&&n()}}if(e)return e.current=t(),function(){return e.current=null}},null==n?n:n.concat(e))}function he(e,t){var n=se(q++,7);return Ee(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function fe(e,t){return Y=8,he(function(){return e},t)}function pe(e){var t=J.context[e.__c],n=se(q++,9);return n.c=e,t?(null==n.__&&(n.__=!0,t.sub(J)),t.props.value):e.__}function ve(e,t){X.useDebugValue&&X.useDebugValue(t?t(e):e)}function me(){var e=se(q++,11);if(!e.__){for(var t=J.__v;null!==t&&!t.__m&&null!==t.__;)t=t.__;var n=t.__m||(t.__m=[0,0]);e.__="P"+n[0]+"-"+n[1]++}return e.__}function ge(){for(var e;e=Z.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(Ce),e.__H.__h.forEach(Ae),e.__H.__h=[]}catch(t){e.__H.__h=[],X.__e(t,e.__v)}}X.__b=function(e){J=null,ee&&ee(e)},X.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),oe&&oe(e,t)},X.__r=function(e){te&&te(e),q=0;var t=(J=e.__c).__H;t&&(G===J?(t.__h=[],J.__h=[],t.__.forEach(function(e){e.__N&&(e.__=e.__N),e.u=e.__N=void 0})):(t.__h.forEach(Ce),t.__h.forEach(Ae),t.__h=[],q=0)),G=J},X.diffed=function(e){ne&&ne(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==Z.push(t)&&K===X.requestAnimationFrame||((K=X.requestAnimationFrame)||be)(ge)),t.__H.__.forEach(function(e){e.u&&(e.__H=e.u),e.u=void 0})),G=J=null},X.__c=function(e,t){t.some(function(e){try{e.__h.forEach(Ce),e.__h=e.__h.filter(function(e){return!e.__||Ae(e)})}catch(n){t.some(function(e){e.__h&&(e.__h=[])}),t=[],X.__e(n,e.__v)}}),re&&re(e,t)},X.unmount=function(e){ie&&ie(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(e){try{Ce(e)}catch(n){t=n}}),n.__H=void 0,t&&X.__e(t,n.__v))};var ye="function"==typeof requestAnimationFrame;function be(e){var t,n=function(){clearTimeout(r),ye&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,35);ye&&(t=requestAnimationFrame(n))}function Ce(e){var t=J,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),J=t}function Ae(e){var t=J;e.__c=e.__(),J=t}function Ee(e,t){return!e||e.length!==t.length||t.some(function(t,n){return t!==e[n]})}function we(e,t){return"function"==typeof t?t(e):t}function Se({value:e,onChange:t,placeholder:n,categories:r,activeCategory:i,onCategoryChange:o,viewMode:s,onViewModeChange:a}){return Q("div",{className:"search-bar-container",children:[Q("div",{className:"search-input-wrapper",children:[Q("ha-icon",{icon:"mdi:magnify"}),Q("input",{type:"text",className:"search-input",value:e,onInput:e=>{t(e.target.value)},placeholder:n})]}),Q("div",{className:"category-filters",children:r.map(e=>Q("button",{className:"category-chip "+(i===e.id?"active":""),onClick:()=>o(e.id),children:[Q("ha-icon",{icon:e.icon}),Q("span",{children:e.label})]},e.id))}),Q("button",{className:"view-mode-toggle",onClick:()=>{a("grid"===s?"list":"grid")},title:"Ansicht umschalten",children:Q("ha-icon",{icon:"grid"===s?"mdi:view-list":"mdi:view-grid"})})]})}function ke({device:e,viewMode:t="grid",onSelect:n,onQuickAction:r,onFavoriteToggle:i,isFavorite:o,animationsEnabled:s=!0}){const[a,c]=ae(!1),[u,l]=ae(!1);return Q("div",{className:["device-card",`device-card--${t}`,`device-card--${e.domain}`,e.isOn&&"device-card--on",!e.isAvailable&&"device-card--unavailable",a&&"device-card--pressed",s&&"device-card--animated",u&&"device-card--ripple"].filter(Boolean).join(" "),onClick:()=>{n&&n(e)},onPointerDown:()=>c(!0),onPointerUp:()=>c(!1),style:{"--device-color":e.color},children:[Q("button",{className:"device-card__favorite",onClick:t=>{t.stopPropagation(),i&&i(e.entity_id)},"aria-label":o?"Remove from favorites":"Add to favorites",children:Q("ha-icon",{icon:o?"mdi:star":"mdi:star-outline"})}),Q("div",{className:"device-card__icon",children:Q("ha-icon",{icon:e.icon})}),Q("div",{className:"device-card__info",children:[Q("h3",{className:"device-card__name",children:e.name}),e.area&&Q("span",{className:"device-card__area",children:e.area}),Q("span",{className:"device-card__state",children:xe(e)})]}),Q("div",{className:"device-card__actions",children:Q("button",{className:"device-card__toggle",onClick:t=>{t.stopPropagation(),l(!0),setTimeout(()=>l(!1),600),r&&r(e,"toggle")},"aria-label":"Toggle",children:Q("ha-icon",{icon:e.isOn?"mdi:power":"mdi:power-off"})})}),u&&Q("div",{className:"device-card__ripple"})]})}function xe(e){if(!e.isAvailable)return"Unavailable";switch(e.domain){case"light":return e.isOn?e.brightness?`${Math.round(e.brightness/255*100)}%`:"On":"Off";case"climate":return e.attributes.temperature?`${e.attributes.temperature}Â°`:e.state;case"cover":return void 0!==e.attributes.current_position?`${e.attributes.current_position}%`:e.state;case"media_player":return"playing"===e.state&&e.attributes.media_title?e.attributes.media_title:e.state;default:return e.state}}function Fe({devices:e,viewMode:t,onSelect:n,onQuickAction:r,onFavoriteToggle:i,favorites:o,animationsEnabled:s}){return Q("div",{className:`device-grid device-grid--${t}`,children:e.map(e=>Q(ke,{device:e,viewMode:t,onSelect:n,onQuickAction:r,onFavoriteToggle:i,isFavorite:o.includes(e.entity_id),animationsEnabled:s},e.entity_id))})}function Me({onBack:e}){return Q("div",{children:[Q("h1",{children:"Detail View"}),Q("button",{onClick:e,children:"Back"})]})}const De={},Ne=e=>{let t;const n=new Set,r=(e,r)=>{const i="function"==typeof e?e(t):e;if(!Object.is(i,t)){const e=t;t=(null!=r?r:"object"!=typeof i||null===i)?i:Object.assign({},t,i),n.forEach(n=>n(t,e))}},i=()=>t,o={setState:r,getState:i,getInitialState:()=>s,subscribe:e=>(n.add(e),()=>n.delete(e)),destroy:()=>{"production"!==(De?"production":void 0)&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},s=t=e(r,i,o);return o};function Be(e,t){for(var n in t)e[n]=t[n];return e}function Le(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function Ie(e,t){var n=t(),r=ae({t:{__:n,u:t}}),i=r[0].t,o=r[1];return le(function(){i.__=n,i.u=t,Oe(i)&&o({t:i})},[e,n,t]),ue(function(){return Oe(i)&&o({t:i}),e(function(){Oe(i)&&o({t:i})})},[e]),n}function Oe(e){var t,n,r=e.u,i=e.__;try{var o=r();return!((t=i)===(n=o)&&(0!==t||1/t==1/n)||t!=t&&n!=n)}catch(s){return!0}}function Re(e){e()}function Pe(e){return e}function Te(){return[!1,Re]}var $e=le;function Ue(e,t){this.props=e,this.context=t}function He(e,t){function n(e){var n=this.props.ref,r=n==e.ref;return!r&&n&&(n.call?n(null):n.current=null),t?!t(this.props,e)||!r:Le(this.props,e)}function r(t){return this.shouldComponentUpdate=n,g(e,t)}return r.displayName="Memo("+(e.displayName||e.name)+")",r.prototype.isReactComponent=!0,r.__f=!0,r.type=e,r}(Ue.prototype=new A).isPureReactComponent=!0,Ue.prototype.shouldComponentUpdate=function(e,t){return Le(this.props,e)||Le(this.state,t)};var We=t.__b;t.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),We&&We(e)};var je="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function Ve(e){function t(t){var n=Be({},t);return delete n.ref,e(n,t.ref||null)}return t.$$typeof=je,t.render=e,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var ze=function(e,t){return null==e?null:M(M(e).map(t))},Qe={map:ze,forEach:ze,count:function(e){return e?M(e).length:0},only:function(e){var t=M(e);if(1!==t.length)throw"Children.only";return t[0]},toArray:M},qe=t.__e;t.__e=function(e,t,n,r){if(e.then)for(var i,o=t;o=o.__;)if((i=o.__c)&&i.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),i.__c(e,t);qe(e,t,n,r)};var Je=t.unmount;function Ge(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach(function(e){"function"==typeof e.__c&&e.__c()}),e.__c.__H=null),null!=(e=Be({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c.__e=!0,e.__c=null),e.__k=e.__k&&e.__k.map(function(e){return Ge(e,t,n)})),e}function Ke(e,t,n){return e&&n&&(e.__v=null,e.__k=e.__k&&e.__k.map(function(e){return Ke(e,t,n)}),e.__c&&e.__c.__P===t&&(e.__e&&n.appendChild(e.__e),e.__c.__e=!0,e.__c.__P=n)),e}function Ye(){this.__u=0,this.o=null,this.__b=null}function Ze(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function Xe(e){var t,n,r;function i(i){if(t||(t=e()).then(function(e){n=e.default||e},function(e){r=e}),r)throw r;if(!n)throw t;return g(n,i)}return i.displayName="Lazy",i.__f=!0,i}function et(){this.i=null,this.l=null}t.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&32&e.__u&&(e.type=null),Je&&Je(e)},(Ye.prototype=new A).__c=function(e,t){var n=t.__c,r=this;null==r.o&&(r.o=[]),r.o.push(n);var i=Ze(r.__v),o=!1,s=function(){o||(o=!0,n.__R=null,i?i(a):a())};n.__R=s;var a=function(){if(! --r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=Ke(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.o.pop();)t.forceUpdate()}};r.__u++||32&t.__u||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(s,s)},Ye.prototype.componentWillUnmount=function(){this.o=[]},Ye.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=Ge(this.__b,n,r.__O=r.__P)}this.__b=null}var i=t.__a&&g(C,null,e.fallback);return i&&(i.__u&=-33),[g(C,null,t.__a?null:e.children),i]};var tt=function(e,t,n){if(++n[1]===n[0]&&e.l.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.l.size))for(n=e.i;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.i=n=n[2]}};function nt(e){return this.getChildContext=function(){return e.context},e.children}function rt(e){var t=this,n=e.h;if(t.componentWillUnmount=function(){H(null,t.v),t.v=null,t.h=null},t.h&&t.h!==n&&t.componentWillUnmount(),!t.v){for(var r=t.__v;null!==r&&!r.__m&&null!==r.__;)r=r.__;t.h=n,t.v={nodeType:1,parentNode:n,childNodes:[],__k:{__m:r.__m},contains:function(){return!0},insertBefore:function(e,n){this.childNodes.push(e),t.h.insertBefore(e,n)},removeChild:function(e){this.childNodes.splice(this.childNodes.indexOf(e)>>>1,1),t.h.removeChild(e)}}}H(g(nt,{context:t.context},e.__v),t.v)}function it(e,t){var n=g(rt,{__v:e,h:t});return n.containerInfo=t,n}(et.prototype=new A).__a=function(e){var t=this,n=Ze(t.__v),r=t.l.get(e);return r[0]++,function(i){var o=function(){t.props.revealOrder?(r.push(i),tt(t,e,r)):i()};n?n(o):o()}},et.prototype.render=function(e){this.i=null,this.l=new Map;var t=M(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.l.set(t[n],this.i=[1,0,this.i]);return e.children},et.prototype.componentDidUpdate=et.prototype.componentDidMount=function(){var e=this;this.l.forEach(function(t,n){tt(e,n,t)})};var ot="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,st=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,at=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,ct=/[A-Z0-9]/g,ut="undefined"!=typeof document,lt=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/:/fil|che|ra/).test(e)};function _t(e,t,n){return null==t.__k&&(t.textContent=""),H(e,t),"function"==typeof n&&n(),e?e.__c:null}function dt(e,t,n){return W(e,t),"function"==typeof n&&n(),e?e.__c:null}A.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(A.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var ht=t.event;function ft(){}function pt(){return this.cancelBubble}function vt(){return this.defaultPrevented}t.event=function(e){return ht&&(e=ht(e)),e.persist=ft,e.isPropagationStopped=pt,e.isDefaultPrevented=vt,e.nativeEvent=e};var mt,gt={enumerable:!1,configurable:!0,get:function(){return this.class}},yt=t.vnode;t.vnode=function(e){"string"==typeof e.type&&function(e){var t=e.props,n=e.type,r={},i=-1===n.indexOf("-");for(var o in t){var s=t[o];if(!("value"===o&&"defaultValue"in t&&null==s||ut&&"children"===o&&"noscript"===n||"class"===o||"className"===o)){var a=o.toLowerCase();"defaultValue"===o&&"value"in t&&null==t.value?o="value":"download"===o&&!0===s?s="":"translate"===a&&"no"===s?s=!1:"o"===a[0]&&"n"===a[1]?"ondoubleclick"===a?o="ondblclick":"onchange"!==a||"input"!==n&&"textarea"!==n||lt(t.type)?"onfocus"===a?o="onfocusin":"onblur"===a?o="onfocusout":at.test(o)&&(o=a):a=o="oninput":i&&st.test(o)?o=o.replace(ct,"-$&").toLowerCase():null===s&&(s=void 0),"oninput"===a&&r[o=a]&&(o="oninputCapture"),r[o]=s}}"select"==n&&r.multiple&&Array.isArray(r.value)&&(r.value=M(t.children).forEach(function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)})),"select"==n&&null!=r.defaultValue&&(r.value=M(t.children).forEach(function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value})),t.class&&!t.className?(r.class=t.class,Object.defineProperty(r,"className",gt)):(t.className&&!t.class||t.class&&t.className)&&(r.class=r.className=t.className),e.props=r}(e),e.$$typeof=ot,yt&&yt(e)};var bt=t.__r;t.__r=function(e){bt&&bt(e),mt=e.__c};var Ct=t.diffed;t.diffed=function(e){Ct&&Ct(e);var t=e.props,n=e.__e;null!=n&&"textarea"===e.type&&"value"in t&&t.value!==n.value&&(n.value=null==t.value?"":t.value),mt=null};var At={ReactCurrentDispatcher:{current:{readContext:function(e){return mt.__n[e.__c].props.value},useCallback:fe,useContext:pe,useDebugValue:ve,useDeferredValue:Pe,useEffect:ue,useId:me,useImperativeHandle:de,useInsertionEffect:$e,useLayoutEffect:le,useMemo:he,useReducer:ce,useRef:_e,useState:ae,useSyncExternalStore:Ie,useTransition:Te}}};function Et(e){return g.bind(null,e)}function wt(e){return!!e&&e.$$typeof===ot}function St(e){return wt(e)&&e.type===C}function kt(e){return!!e&&!!e.displayName&&("string"==typeof e.displayName||e.displayName instanceof String)&&e.displayName.startsWith("Memo(")}function xt(e){return wt(e)?j.apply(null,arguments):e}function Ft(e){return!!e.__k&&(H(null,e),!0)}function Mt(e){return e&&(e.base||1===e.nodeType&&e)||null}var Dt=function(e,t){return e(t)},Nt=function(e,t){return e(t)},Bt=C,Lt=wt,It={useState:ae,useId:me,useReducer:ce,useEffect:ue,useLayoutEffect:le,useInsertionEffect:$e,useTransition:Te,useDeferredValue:Pe,useSyncExternalStore:Ie,startTransition:Re,useRef:_e,useImperativeHandle:de,useMemo:he,useCallback:fe,useContext:pe,useDebugValue:ve,version:"18.3.1",Children:Qe,render:_t,hydrate:dt,unmountComponentAtNode:Ft,createPortal:it,createElement:g,createContext:V,createFactory:Et,cloneElement:xt,createRef:b,Fragment:C,isValidElement:wt,isElement:Lt,isFragment:St,isMemo:kt,findDOMNode:Mt,Component:A,PureComponent:Ue,memo:He,forwardRef:Ve,flushSync:Nt,unstable_batchedUpdates:Dt,StrictMode:Bt,Suspense:Ye,SuspenseList:et,lazy:Xe,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:At};function Ot(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Rt(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var n=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(t){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,r.get?r:{enumerable:!0,get:function(){return e[t]}})}),n}var Pt={exports:{}},Tt={};const $t=Rt(Object.freeze(Object.defineProperty({__proto__:null,Children:Qe,Component:A,Fragment:C,PureComponent:Ue,StrictMode:Bt,Suspense:Ye,SuspenseList:et,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:At,cloneElement:xt,createContext:V,createElement:g,createFactory:Et,createPortal:it,createRef:b,default:It,findDOMNode:Mt,flushSync:Nt,forwardRef:Ve,hydrate:dt,isElement:Lt,isFragment:St,isMemo:kt,isValidElement:wt,lazy:Xe,memo:He,render:_t,startTransition:Re,unmountComponentAtNode:Ft,unstable_batchedUpdates:Dt,useCallback:fe,useContext:pe,useDebugValue:ve,useDeferredValue:Pe,useEffect:ue,useErrorBoundary:function(e){var t=se(q++,10),n=ae();return t.__=e,J.componentDidCatch||(J.componentDidCatch=function(e,r){t.__&&t.__(e,r),n[1](e)}),[n[0],function(){n[1](void 0)}]},useId:me,useImperativeHandle:de,useInsertionEffect:$e,useLayoutEffect:le,useMemo:he,useReducer:ce,useRef:_e,useState:ae,useSyncExternalStore:Ie,useTransition:Te,version:"18.3.1"},Symbol.toStringTag,{value:"Module"})));var Ut={exports:{}},Ht={},Wt=$t;var jt="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},Vt=Wt.useState,zt=Wt.useEffect,Qt=Wt.useLayoutEffect,qt=Wt.useDebugValue;function Jt(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!jt(e,n)}catch(r){return!0}}var Gt="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=Vt({inst:{value:n,getSnapshot:t}}),i=r[0].inst,o=r[1];return Qt(function(){i.value=n,i.getSnapshot=t,Jt(i)&&o({inst:i})},[e,n,t]),zt(function(){return Jt(i)&&o({inst:i}),e(function(){Jt(i)&&o({inst:i})})},[e]),qt(n),n};Ht.useSyncExternalStore=void 0!==Wt.useSyncExternalStore?Wt.useSyncExternalStore:Gt,Ut.exports=Ht;var Kt=$t,Yt=Ut.exports;
/**
   * @license React
   * use-sync-external-store-shim/with-selector.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   */var Zt="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},Xt=Yt.useSyncExternalStore,en=Kt.useRef,tn=Kt.useEffect,nn=Kt.useMemo,rn=Kt.useDebugValue;Tt.useSyncExternalStoreWithSelector=function(e,t,n,r,i){var o=en(null);if(null===o.current){var s={hasValue:!1,value:null};o.current=s}else s=o.current;o=nn(function(){function e(e){if(!c){if(c=!0,o=e,e=r(e),void 0!==i&&s.hasValue){var t=s.value;if(i(t,e))return a=t}return a=e}if(t=a,Zt(o,e))return t;var n=r(e);return void 0!==i&&i(t,n)?(o=e,t):(o=e,a=n)}var o,a,c=!1,u=void 0===n?null:n;return[function(){return e(t())},null===u?void 0:function(){return e(u())}]},[t,n,r,i]);var a=Xt(e,o[0],o[1]);return tn(function(){s.hasValue=!0,s.value=a},[a]),rn(a),a},Pt.exports=Tt;const on=Ot(Pt.exports),sn={},{useDebugValue:an}=It,{useSyncExternalStoreWithSelector:cn}=on;let un=!1;const ln=e=>e;const _n=e=>{"production"!==(sn?"production":void 0)&&"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t="function"==typeof e?(e=>e?Ne(e):Ne)(e):e,n=(e,n)=>function(e,t=ln,n){"production"!==(sn?"production":void 0)&&n&&!un&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),un=!0);const r=cn(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return an(r),r}(t,e,n);return Object.assign(n,t),n},dn=e=>(t,n,r)=>{const i=r.subscribe;r.subscribe=(e,t,n)=>{let o=e;if(t){const i=(null==n?void 0:n.equalityFn)||Object.is;let s=e(r.getState());o=n=>{const r=e(n);if(!i(s,r)){const e=s;t(s=r,e)}},(null==n?void 0:n.fireImmediately)&&t(s,s)}return i(o)};return e(t,n,r)},hn={getItem(e){try{return localStorage.getItem(e)}catch(t){return console.warn("localStorage read failed:",t),null}},setItem(e,t){try{return localStorage.setItem(e,t),!0}catch(n){return console.warn("localStorage write failed:",n),!1}},removeItem(e){try{localStorage.removeItem(e)}catch(t){console.warn("localStorage remove failed:",t)}}},fn=(pn=dn((e,t)=>({hass:null,config:{},favorites:[],recentSearches:[],selectedCategory:"all",viewMode:"grid",theme:"auto",actionFeedback:null,isDetailViewOpen:!1,searchQuery:"",setHass:t=>e({hass:t}),setConfig:t=>{if(!t)return void console.error("Invalid config provided");let n=t.default_favorites||[];try{const e=hn.getItem("fast-search-favorites");if(e){const t=JSON.parse(e);Array.isArray(t)&&(n=t)}}catch(i){console.warn("Failed to parse saved favorites:",i)}let r=[];try{const e=hn.getItem("fast-search-recent");if(e){const t=JSON.parse(e);Array.isArray(t)&&(r=t)}}catch(i){console.warn("Failed to parse recent searches:",i)}e({config:t,favorites:n,recentSearches:r,theme:t.theme||"auto",viewMode:t.default_view||"grid"})},addFavorite:t=>e(e=>{if(!t||e.favorites.includes(t))return{};const n=[...e.favorites,t];return hn.setItem("fast-search-favorites",JSON.stringify(n)),{favorites:n}}),removeFavorite:t=>e(e=>{const n=e.favorites.filter(e=>e!==t);return hn.setItem("fast-search-favorites",JSON.stringify(n)),{favorites:n}}),toggleFavorite:e=>{const n=t();n.favorites.includes(e)?n.removeFavorite(e):n.addFavorite(e)},addRecentSearch:t=>e(e=>{if(!t||!t.trim())return{};const n=t.trim(),r=e.recentSearches.filter(e=>e!==n),i=[n,...r].slice(0,5);return hn.setItem("fast-search-recent",JSON.stringify(i)),{recentSearches:i}}),clearRecentSearches:()=>{hn.removeItem("fast-search-recent"),e({recentSearches:[]})},setSearchQuery:t=>e({searchQuery:t}),setSelectedCategory:t=>e({selectedCategory:t}),setViewMode:t=>e({viewMode:t}),setTheme:t=>e({theme:t}),setDetailViewOpen:t=>e({isDetailViewOpen:t}),setActionFeedback:n=>{e({actionFeedback:n}),n&&setTimeout(()=>{t().actionFeedback===n&&e({actionFeedback:null})},3e3)},getDevicesByCategory:e=>{const{hass:n}=t();return(null==n?void 0:n.states)?Object.values(n.states).filter(t=>"all"===e||t.entity_id.split(".")[0]===e):[]},getFavoriteDevices:()=>{const{hass:e,favorites:n}=t();return(null==e?void 0:e.states)?n.map(t=>e.states[t]).filter(Boolean):[]},isEntityAvailable:e=>{var n;const{hass:r}=t(),i=null==(n=null==r?void 0:r.states)?void 0:n[e];return i&&"unavailable"!==i.state},getEntity:e=>{var n;const{hass:r}=t();return null==(n=null==r?void 0:r.states)?void 0:n[e]},getDevices:()=>{const{hass:e,config:n}=t();if(!(null==e?void 0:e.states))return[];const r=(null==n?void 0:n.domains)||["light","switch","climate","cover","media_player","fan","lock","vacuum","sensor"];return Object.values(e.states).filter(e=>{const t=e.entity_id.split(".")[0];return r.includes(t)&&!e.hidden&&!e.entity_id.includes("_unknown_")}).map(e=>({entity_id:e.entity_id,domain:e.entity_id.split(".")[0],state:e.state,name:e.attributes.friendly_name||e.entity_id,area:e.area_id||e.attributes.area||"",attributes:e.attributes,last_changed:e.last_changed,last_updated:e.last_updated,isOn:["on","open","playing","heat","cool"].includes(e.state),isAvailable:"unavailable"!==e.state}))},reset:()=>{e({hass:null,actionFeedback:null,isDetailViewOpen:!1,searchQuery:""})}})))?_n(pn):_n;var pn;function vn(e){return Array.isArray?Array.isArray(e):"[object Array]"===En(e)}function mn(e){return"string"==typeof e}function gn(e){return"number"==typeof e}function yn(e){return!0===e||!1===e||function(e){return bn(e)&&null!==e}(e)&&"[object Boolean]"==En(e)}function bn(e){return"object"==typeof e}function Cn(e){return null!=e}function An(e){return!e.trim().length}function En(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const wn=Object.prototype.hasOwnProperty;class Sn{constructor(e){this._keys=[],this._keyMap={};let t=0;e.forEach(e=>{let n=kn(e);this._keys.push(n),this._keyMap[n.id]=n,t+=n.weight}),this._keys.forEach(e=>{e.weight/=t})}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function kn(e){let t=null,n=null,r=null,i=1,o=null;if(mn(e)||vn(e))r=e,t=xn(e),n=Fn(e);else{if(!wn.call(e,"name"))throw new Error((e=>`Missing ${e} property in key`)("name"));const s=e.name;if(r=s,wn.call(e,"weight")&&(i=e.weight,i<=0))throw new Error((e=>`Property 'weight' in key '${e}' must be a positive integer`)(s));t=xn(s),n=Fn(s),o=e.getFn}return{path:t,id:n,weight:i,src:r,getFn:o}}function xn(e){return vn(e)?e:e.split(".")}function Fn(e){return vn(e)?e.join("."):e}var Mn={isCaseSensitive:!1,ignoreDiacritics:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(e,t)=>e.score===t.score?e.idx<t.idx?-1:1:e.score<t.score?-1:1,includeMatches:!1,findAllMatches:!1,minMatchCharLength:1,location:0,threshold:.6,distance:100,...{useExtendedSearch:!1,getFn:function(e,t){let n=[],r=!1;const i=(e,t,o)=>{if(Cn(e))if(t[o]){const s=e[t[o]];if(!Cn(s))return;if(o===t.length-1&&(mn(s)||gn(s)||yn(s)))n.push(function(e){return null==e?"":function(e){if("string"==typeof e)return e;let t=e+"";return"0"==t&&1/e==-1/0?"-0":t}(e)}(s));else if(vn(s)){r=!0;for(let e=0,n=s.length;e<n;e+=1)i(s[e],t,o+1)}else t.length&&i(s,t,o+1)}else n.push(e)};return i(e,mn(t)?t.split("."):t,0),r?n:n[0]},ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1}};const Dn=/[^ ]+/g;class Nn{constructor({getFn:e=Mn.getFn,fieldNormWeight:t=Mn.fieldNormWeight}={}){this.norm=function(e=1,t=3){const n=new Map,r=Math.pow(10,t);return{get(t){const i=t.match(Dn).length;if(n.has(i))return n.get(i);const o=1/Math.pow(i,.5*e),s=parseFloat(Math.round(o*r)/r);return n.set(i,s),s},clear(){n.clear()}}}(t,3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(e=[]){this.docs=e}setIndexRecords(e=[]){this.records=e}setKeys(e=[]){this.keys=e,this._keysMap={},e.forEach((e,t)=>{this._keysMap[e.id]=t})}create(){!this.isCreated&&this.docs.length&&(this.isCreated=!0,mn(this.docs[0])?this.docs.forEach((e,t)=>{this._addString(e,t)}):this.docs.forEach((e,t)=>{this._addObject(e,t)}),this.norm.clear())}add(e){const t=this.size();mn(e)?this._addString(e,t):this._addObject(e,t)}removeAt(e){this.records.splice(e,1);for(let t=e,n=this.size();t<n;t+=1)this.records[t].i-=1}getValueForItemAtKeyId(e,t){return e[this._keysMap[t]]}size(){return this.records.length}_addString(e,t){if(!Cn(e)||An(e))return;let n={v:e,i:t,n:this.norm.get(e)};this.records.push(n)}_addObject(e,t){let n={i:t,$:{}};this.keys.forEach((t,r)=>{let i=t.getFn?t.getFn(e):this.getFn(e,t.path);if(Cn(i))if(vn(i)){let e=[];const t=[{nestedArrIndex:-1,value:i}];for(;t.length;){const{nestedArrIndex:n,value:r}=t.pop();if(Cn(r))if(mn(r)&&!An(r)){let t={v:r,i:n,n:this.norm.get(r)};e.push(t)}else vn(r)&&r.forEach((e,n)=>{t.push({nestedArrIndex:n,value:e})})}n.$[r]=e}else if(mn(i)&&!An(i)){let e={v:i,n:this.norm.get(i)};n.$[r]=e}}),this.records.push(n)}toJSON(){return{keys:this.keys,records:this.records}}}function Bn(e,t,{getFn:n=Mn.getFn,fieldNormWeight:r=Mn.fieldNormWeight}={}){const i=new Nn({getFn:n,fieldNormWeight:r});return i.setKeys(e.map(kn)),i.setSources(t),i.create(),i}function Ln(e,{errors:t=0,currentLocation:n=0,expectedLocation:r=0,distance:i=Mn.distance,ignoreLocation:o=Mn.ignoreLocation}={}){const s=t/e.length;if(o)return s;const a=Math.abs(r-n);return i?s+a/i:a?1:s}const In=32;function On(e,t,n,{location:r=Mn.location,distance:i=Mn.distance,threshold:o=Mn.threshold,findAllMatches:s=Mn.findAllMatches,minMatchCharLength:a=Mn.minMatchCharLength,includeMatches:c=Mn.includeMatches,ignoreLocation:u=Mn.ignoreLocation}={}){if(t.length>In)throw new Error(`Pattern length exceeds max of ${In}.`);const l=t.length,_=e.length,d=Math.max(0,Math.min(r,_));let h=o,f=d;const p=a>1||c,v=p?Array(_):[];let m;for(;(m=e.indexOf(t,f))>-1;){let e=Ln(t,{currentLocation:m,expectedLocation:d,distance:i,ignoreLocation:u});if(h=Math.min(e,h),f=m+l,p){let e=0;for(;e<l;)v[m+e]=1,e+=1}}f=-1;let g=[],y=1,b=l+_;const C=1<<l-1;for(let E=0;E<l;E+=1){let r=0,o=b;for(;r<o;){Ln(t,{errors:E,currentLocation:d+o,expectedLocation:d,distance:i,ignoreLocation:u})<=h?r=o:b=o,o=Math.floor((b-r)/2+r)}b=o;let a=Math.max(1,d-o+1),c=s?_:Math.min(d+o,_)+l,m=Array(c+2);m[c+1]=(1<<E)-1;for(let s=c;s>=a;s-=1){let r=s-1,o=n[e.charAt(r)];if(p&&(v[r]=+!!o),m[s]=(m[s+1]<<1|1)&o,E&&(m[s]|=(g[s+1]|g[s])<<1|1|g[s+1]),m[s]&C&&(y=Ln(t,{errors:E,currentLocation:r,expectedLocation:d,distance:i,ignoreLocation:u}),y<=h)){if(h=y,f=r,f<=d)break;a=Math.max(1,2*d-f)}}if(Ln(t,{errors:E+1,currentLocation:d,expectedLocation:d,distance:i,ignoreLocation:u})>h)break;g=m}const A={isMatch:f>=0,score:Math.max(.001,y)};if(p){const e=function(e=[],t=Mn.minMatchCharLength){let n=[],r=-1,i=-1,o=0;for(let s=e.length;o<s;o+=1){let s=e[o];s&&-1===r?r=o:s||-1===r||(i=o-1,i-r+1>=t&&n.push([r,i]),r=-1)}return e[o-1]&&o-r>=t&&n.push([r,o-1]),n}(v,a);e.length?c&&(A.indices=e):A.isMatch=!1}return A}function Rn(e){let t={};for(let n=0,r=e.length;n<r;n+=1){const i=e.charAt(n);t[i]=(t[i]||0)|1<<r-n-1}return t}const Pn=String.prototype.normalize?e=>e.normalize("NFD").replace(/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/g,""):e=>e;class Tn{constructor(e,{location:t=Mn.location,threshold:n=Mn.threshold,distance:r=Mn.distance,includeMatches:i=Mn.includeMatches,findAllMatches:o=Mn.findAllMatches,minMatchCharLength:s=Mn.minMatchCharLength,isCaseSensitive:a=Mn.isCaseSensitive,ignoreDiacritics:c=Mn.ignoreDiacritics,ignoreLocation:u=Mn.ignoreLocation}={}){if(this.options={location:t,threshold:n,distance:r,includeMatches:i,findAllMatches:o,minMatchCharLength:s,isCaseSensitive:a,ignoreDiacritics:c,ignoreLocation:u},e=a?e:e.toLowerCase(),e=c?Pn(e):e,this.pattern=e,this.chunks=[],!this.pattern.length)return;const l=(e,t)=>{this.chunks.push({pattern:e,alphabet:Rn(e),startIndex:t})},_=this.pattern.length;if(_>In){let e=0;const t=_%In,n=_-t;for(;e<n;)l(this.pattern.substr(e,In),e),e+=In;if(t){const e=_-In;l(this.pattern.substr(e),e)}}else l(this.pattern,0)}searchIn(e){const{isCaseSensitive:t,ignoreDiacritics:n,includeMatches:r}=this.options;if(e=t?e:e.toLowerCase(),e=n?Pn(e):e,this.pattern===e){let t={isMatch:!0,score:0};return r&&(t.indices=[[0,e.length-1]]),t}const{location:i,distance:o,threshold:s,findAllMatches:a,minMatchCharLength:c,ignoreLocation:u}=this.options;let l=[],_=0,d=!1;this.chunks.forEach(({pattern:t,alphabet:n,startIndex:h})=>{const{isMatch:f,score:p,indices:v}=On(e,t,n,{location:i+h,distance:o,threshold:s,findAllMatches:a,minMatchCharLength:c,includeMatches:r,ignoreLocation:u});f&&(d=!0),_+=p,f&&v&&(l=[...l,...v])});let h={isMatch:d,score:d?_/this.chunks.length:1};return d&&r&&(h.indices=l),h}}class $n{constructor(e){this.pattern=e}static isMultiMatch(e){return Un(e,this.multiRegex)}static isSingleMatch(e){return Un(e,this.singleRegex)}search(){}}function Un(e,t){const n=e.match(t);return n?n[1]:null}class Hn extends $n{constructor(e,{location:t=Mn.location,threshold:n=Mn.threshold,distance:r=Mn.distance,includeMatches:i=Mn.includeMatches,findAllMatches:o=Mn.findAllMatches,minMatchCharLength:s=Mn.minMatchCharLength,isCaseSensitive:a=Mn.isCaseSensitive,ignoreDiacritics:c=Mn.ignoreDiacritics,ignoreLocation:u=Mn.ignoreLocation}={}){super(e),this._bitapSearch=new Tn(e,{location:t,threshold:n,distance:r,includeMatches:i,findAllMatches:o,minMatchCharLength:s,isCaseSensitive:a,ignoreDiacritics:c,ignoreLocation:u})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}}class Wn extends $n{constructor(e){super(e)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let t,n=0;const r=[],i=this.pattern.length;for(;(t=e.indexOf(this.pattern,n))>-1;)n=t+i,r.push([t,n-1]);const o=!!r.length;return{isMatch:o,score:o?0:1,indices:r}}}const jn=[class extends $n{constructor(e){super(e)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){const t=e===this.pattern;return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}},Wn,class extends $n{constructor(e){super(e)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){const t=e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}},class extends $n{constructor(e){super(e)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){const t=!e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}},class extends $n{constructor(e){super(e)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){const t=!e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}},class extends $n{constructor(e){super(e)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){const t=e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[e.length-this.pattern.length,e.length-1]}}},class extends $n{constructor(e){super(e)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){const t=-1===e.indexOf(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}},Hn],Vn=jn.length,zn=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/;const Qn=new Set([Hn.type,Wn.type]);class qn{constructor(e,{isCaseSensitive:t=Mn.isCaseSensitive,ignoreDiacritics:n=Mn.ignoreDiacritics,includeMatches:r=Mn.includeMatches,minMatchCharLength:i=Mn.minMatchCharLength,ignoreLocation:o=Mn.ignoreLocation,findAllMatches:s=Mn.findAllMatches,location:a=Mn.location,threshold:c=Mn.threshold,distance:u=Mn.distance}={}){this.query=null,this.options={isCaseSensitive:t,ignoreDiacritics:n,includeMatches:r,minMatchCharLength:i,findAllMatches:s,ignoreLocation:o,location:a,threshold:c,distance:u},e=t?e:e.toLowerCase(),e=n?Pn(e):e,this.pattern=e,this.query=function(e,t={}){return e.split("|").map(e=>{let n=e.trim().split(zn).filter(e=>e&&!!e.trim()),r=[];for(let i=0,o=n.length;i<o;i+=1){const e=n[i];let o=!1,s=-1;for(;!o&&++s<Vn;){const n=jn[s];let i=n.isMultiMatch(e);i&&(r.push(new n(i,t)),o=!0)}if(!o)for(s=-1;++s<Vn;){const n=jn[s];let i=n.isSingleMatch(e);if(i){r.push(new n(i,t));break}}}return r})}(this.pattern,this.options)}static condition(e,t){return t.useExtendedSearch}searchIn(e){const t=this.query;if(!t)return{isMatch:!1,score:1};const{includeMatches:n,isCaseSensitive:r,ignoreDiacritics:i}=this.options;e=r?e:e.toLowerCase(),e=i?Pn(e):e;let o=0,s=[],a=0;for(let c=0,u=t.length;c<u;c+=1){const r=t[c];s.length=0,o=0;for(let t=0,i=r.length;t<i;t+=1){const i=r[t],{isMatch:c,indices:u,score:l}=i.search(e);if(!c){a=0,o=0,s.length=0;break}if(o+=1,a+=l,n){const e=i.constructor.type;Qn.has(e)?s=[...s,...u]:s.push(u)}}if(o){let e={isMatch:!0,score:a/o};return n&&(e.indices=s),e}}return{isMatch:!1,score:1}}}const Jn=[];function Gn(e,t){for(let n=0,r=Jn.length;n<r;n+=1){let r=Jn[n];if(r.condition(e,t))return new r(e,t)}return new Tn(e,t)}const Kn="$and",Yn="$or",Zn="$path",Xn="$val",er=e=>!(!e[Kn]&&!e[Yn]),tr=e=>({[Kn]:Object.keys(e).map(t=>({[t]:e[t]}))});function nr(e,t,{auto:n=!0}={}){const r=e=>{let i=Object.keys(e);const o=(e=>!!e[Zn])(e);if(!o&&i.length>1&&!er(e))return r(tr(e));if((e=>!vn(e)&&bn(e)&&!er(e))(e)){const r=o?e[Zn]:i[0],s=o?e[Xn]:e[r];if(!mn(s))throw new Error((e=>`Invalid value for key ${e}`)(r));const a={keyId:Fn(r),pattern:s};return n&&(a.searcher=Gn(s,t)),a}let s={children:[],operator:i[0]};return i.forEach(t=>{const n=e[t];vn(n)&&n.forEach(e=>{s.children.push(r(e))})}),s};return er(e)||(e=tr(e)),r(e)}function rr(e,t){const n=e.matches;t.matches=[],Cn(n)&&n.forEach(e=>{if(!Cn(e.indices)||!e.indices.length)return;const{indices:n,value:r}=e;let i={indices:n,value:r};e.key&&(i.key=e.key.src),e.idx>-1&&(i.refIndex=e.idx),t.matches.push(i)})}function ir(e,t){t.score=e.score}class or{constructor(e,t={},n){this.options={...Mn,...t},this.options.useExtendedSearch,this._keyStore=new Sn(this.options.keys),this.setCollection(e,n)}setCollection(e,t){if(this._docs=e,t&&!(t instanceof Nn))throw new Error("Incorrect 'index' type");this._myIndex=t||Bn(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(e){Cn(e)&&(this._docs.push(e),this._myIndex.add(e))}remove(e=()=>!1){const t=[];for(let n=0,r=this._docs.length;n<r;n+=1){const i=this._docs[n];e(i,n)&&(this.removeAt(n),n-=1,r-=1,t.push(i))}return t}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e,{limit:t=-1}={}){const{includeMatches:n,includeScore:r,shouldSort:i,sortFn:o,ignoreFieldNorm:s}=this.options;let a=mn(e)?mn(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return function(e,{ignoreFieldNorm:t=Mn.ignoreFieldNorm}){e.forEach(e=>{let n=1;e.matches.forEach(({key:e,norm:r,score:i})=>{const o=e?e.weight:null;n*=Math.pow(0===i&&o?Number.EPSILON:i,(o||1)*(t?1:r))}),e.score=n})}(a,{ignoreFieldNorm:s}),i&&a.sort(o),gn(t)&&t>-1&&(a=a.slice(0,t)),function(e,t,{includeMatches:n=Mn.includeMatches,includeScore:r=Mn.includeScore}={}){const i=[];return n&&i.push(rr),r&&i.push(ir),e.map(e=>{const{idx:n}=e,r={item:t[n],refIndex:n};return i.length&&i.forEach(t=>{t(e,r)}),r})}(a,this._docs,{includeMatches:n,includeScore:r})}_searchStringList(e){const t=Gn(e,this.options),{records:n}=this._myIndex,r=[];return n.forEach(({v:e,i:n,n:i})=>{if(!Cn(e))return;const{isMatch:o,score:s,indices:a}=t.searchIn(e);o&&r.push({item:e,idx:n,matches:[{score:s,value:e,norm:i,indices:a}]})}),r}_searchLogical(e){const t=nr(e,this.options),n=(e,t,r)=>{if(!e.children){const{keyId:n,searcher:i}=e,o=this._findMatches({key:this._keyStore.get(n),value:this._myIndex.getValueForItemAtKeyId(t,n),searcher:i});return o&&o.length?[{idx:r,item:t,matches:o}]:[]}const i=[];for(let o=0,s=e.children.length;o<s;o+=1){const s=e.children[o],a=n(s,t,r);if(a.length)i.push(...a);else if(e.operator===Kn)return[]}return i},r=this._myIndex.records,i={},o=[];return r.forEach(({$:e,i:r})=>{if(Cn(e)){let s=n(t,e,r);s.length&&(i[r]||(i[r]={idx:r,item:e,matches:[]},o.push(i[r])),s.forEach(({matches:e})=>{i[r].matches.push(...e)}))}}),o}_searchObjectList(e){const t=Gn(e,this.options),{keys:n,records:r}=this._myIndex,i=[];return r.forEach(({$:e,i:r})=>{if(!Cn(e))return;let o=[];n.forEach((n,r)=>{o.push(...this._findMatches({key:n,value:e[r],searcher:t}))}),o.length&&i.push({idx:r,item:e,matches:o})}),i}_findMatches({key:e,value:t,searcher:n}){if(!Cn(t))return[];let r=[];if(vn(t))t.forEach(({v:t,i:i,n:o})=>{if(!Cn(t))return;const{isMatch:s,score:a,indices:c}=n.searchIn(t);s&&r.push({score:a,key:e,value:t,idx:i,norm:o,indices:c})});else{const{v:i,n:o}=t,{isMatch:s,score:a,indices:c}=n.searchIn(i);s&&r.push({score:a,key:e,value:i,norm:o,indices:c})}return r}}function sr(e,t){return he(()=>{if(!(null==e?void 0:e.states))return[];const n=e.states,r=(null==t?void 0:t.domains)||["light","switch","climate","cover","media_player","fan","lock","vacuum"];return Object.values(n).filter(e=>{var n;const i=e.entity_id.split(".")[0];return!!r.includes(i)&&(!e.attributes.hidden&&(!e.entity_id.includes("_unknown_")&&!(null==(n=null==t?void 0:t.exclude_entities)?void 0:n.includes(e.entity_id))))}).map(e=>function(e){var t,n,r;const i=e.entity_id.split(".")[0];return{entity_id:e.entity_id,domain:i,state:e.state,name:e.attributes.friendly_name||_r(e.entity_id),area:lr(e),attributes:e.attributes,last_changed:e.last_changed,last_updated:e.last_updated,isOn:ar(e),isAvailable:"unavailable"!==e.state,icon:e.attributes.icon||cr(e),color:ur(e),brightness:e.attributes.brightness,color_temp:e.attributes.color_temp,rgb_color:e.attributes.rgb_color,temperature:e.attributes.temperature,target_temp:e.attributes.temperature,current_temp:e.attributes.current_temperature,position:e.attributes.current_position,volume:e.attributes.volume_level,media_title:e.attributes.media_title,media_artist:e.attributes.media_artist,supportsColor:"light"===i&&(null==(t=e.attributes.supported_color_modes)?void 0:t.some(e=>["hs","rgb","xy","rgbw","rgbww"].includes(e))),supportsBrightness:"light"===i&&((null==(n=e.attributes.supported_color_modes)?void 0:n.includes("brightness"))||void 0!==e.attributes.brightness),supportsColorTemp:"light"===i&&(null==(r=e.attributes.supported_color_modes)?void 0:r.includes("color_temp")),supportsTemperature:"climate"===i,supportsPosition:"cover"===i,supportsVolume:"media_player"===i,supportsTilt:"cover"===i&&void 0!==e.attributes.current_tilt_position}}(e))},[null==e?void 0:e.states,null==t?void 0:t.domains,null==t?void 0:t.exclude_entities])}function ar(e){var t;const n=e.entity_id.split(".")[0],r=e.state;return(null==(t={light:["on"],switch:["on"],fan:["on"],climate:["heat","cool","heat_cool","auto","dry","fan_only"],cover:["open","opening"],media_player:["playing","paused","idle"],lock:["unlocked"],vacuum:["cleaning","returning","docked"]}[n])?void 0:t.includes(r))||"on"===r}function cr(e){const t=e.entity_id.split(".")[0],n=e.state;return{light:"on"===n?"mdi:lightbulb":"mdi:lightbulb-outline",switch:"on"===n?"mdi:toggle-switch":"mdi:toggle-switch-off",climate:"mdi:thermostat",cover:"open"===n?"mdi:window-open":"mdi:window-closed",media_player:"mdi:cast",fan:"on"===n?"mdi:fan":"mdi:fan-off",lock:"locked"===n?"mdi:lock":"mdi:lock-open",vacuum:"mdi:robot-vacuum",sensor:"mdi:eye"}[t]||"mdi:home"}function ur(e){const t=e.entity_id.split(".")[0],n=e.state;if("unavailable"===n)return"var(--disabled-text-color)";return{light:"on"===n?e.attributes.rgb_color?`rgb(${e.attributes.rgb_color.join(",")})`:"var(--amber-color)":"var(--disabled-text-color)",switch:"on"===n?"var(--primary-color)":"var(--disabled-text-color)",climate:"heating"===e.attributes.hvac_action?"var(--deep-orange-color)":"cooling"===e.attributes.hvac_action?"var(--blue-color)":"var(--disabled-text-color)",cover:"open"===n?"var(--orange-color)":"var(--disabled-text-color)",media_player:"playing"===n?"var(--purple-color)":"var(--disabled-text-color)",fan:"on"===n?"var(--cyan-color)":"var(--disabled-text-color)",lock:"locked"===n?"var(--green-color)":"var(--red-color)",vacuum:["cleaning","returning"].includes(n)?"var(--teal-color)":"var(--disabled-text-color)"}[t]||"var(--primary-text-color)"}function lr(e,t){return e.attributes.area||""}function _r(e){return(e.split(".")[1]||e).replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function dr({hass:e,config:t,onAction:n,shadowRoot:r}){const[i,o]=ae(null),{searchQuery:s,setSearchQuery:a,favorites:c,toggleFavorite:u,selectedCategory:l,setSelectedCategory:_,viewMode:d,setViewMode:h}=fn(),f=function(e,t,n={}){const{category:r="all",favorites:i=[],maxResults:o=50,threshold:s=.3}=n,a=he(()=>e||[],[e]),c=he(()=>0===a.length?null:new or(a,{keys:[{name:"name",weight:.4},{name:"entity_id",weight:.2},{name:"area",weight:.2},{name:"domain",weight:.1}],threshold:s,includeScore:!0,shouldSort:!0,minMatchCharLength:2,findAllMatches:!0,ignoreLocation:!0,useExtendedSearch:!0}),[a,s]);return he(()=>{let e=a;return"all"!==r&&r&&(e=e.filter(e=>e.domain===r)),t&&t.trim()&&c&&(e=c.search(t.trim()).map(e=>({...e.item,searchScore:e.score}))),e.sort((e,t)=>{const n=i.includes(e.entity_id);return n!==i.includes(t.entity_id)?n?-1:1:e.isAvailable!==t.isAvailable?e.isAvailable?-1:1:void 0!==e.searchScore&&void 0!==t.searchScore?e.searchScore-t.searchScore:e.name.localeCompare(t.name)}),e.slice(0,o)},[a,t,r,i,c,o])}(sr(e,t),s,{category:l,favorites:(null==t?void 0:t.show_favorites)?c:null}),p=he(()=>{const e=[{id:"all",label:"All",icon:"mdi:home"},{id:"light",label:"Lights",icon:"mdi:lightbulb"},{id:"switch",label:"Switches",icon:"mdi:toggle-switch"},{id:"climate",label:"Climate",icon:"mdi:thermostat"},{id:"cover",label:"Covers",icon:"mdi:window-shutter"},{id:"media_player",label:"Media",icon:"mdi:cast"}];return(null==t?void 0:t.categories)?e.filter(e=>t.categories.includes(e.id)||"all"===e.id):e},[t]);return e?i?Q(Me,{device:i,hass:e,onBack:()=>{o(null)},onAction:async e=>{console.log("Detail action:",e),await n(e)},onFavoriteToggle:()=>u(i.entity_id),isFavorite:c.includes(i.entity_id)}):Q("div",{className:"fast-search-container",children:[Q(Se,{value:s,onChange:a,placeholder:(null==t?void 0:t.search_placeholder)||"Search devices...",categories:p,activeCategory:l,onCategoryChange:_,viewMode:d,onViewModeChange:h}),Q(Fe,{devices:f,viewMode:d,onSelect:e=>{console.log("Device selected:",e),o(e)},onQuickAction:async e=>{console.log("Quick action:",e.entity_id),await n({type:"TOGGLE",entityId:e.entity_id})},onFavoriteToggle:u,favorites:c,animationsEnabled:!1!==(null==t?void 0:t.animations),maxResults:(null==t?void 0:t.max_results)||50}),0===f.length&&s&&Q("div",{className:"no-results",children:Q("p",{children:['No devices found for "',s,'"']})})]}):Q("div",{className:"loading-container",children:Q("p",{children:"Waiting for Home Assistant..."})})}or.version="7.1.0",or.createIndex=Bn,or.parseIndex=function(e,{getFn:t=Mn.getFn,fieldNormWeight:n=Mn.fieldNormWeight}={}){const{keys:r,records:i}=e,o=new Nn({getFn:t,fieldNormWeight:n});return o.setKeys(r),o.setIndexRecords(i),o},or.config=Mn,or.parseQuery=nr,function(...e){Jn.push(...e)}(qn);class hr extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.renderApp=this.renderApp.bind(this),this.handleAction=this.handleAction.bind(this)}connectedCallback(){if(console.log("FastSearchCard connected"),!this.mountPoint){this.mountPoint=document.createElement("div"),this.mountPoint.id="app-root";const e=document.createElement("style");e.textContent=".fast-search-container{padding:16px;font-family:var(--paper-font-body1_-_font-family)}.device-card{padding:12px;margin:8px;background:var(--card-background-color);border-radius:8px;cursor:pointer}",this.shadowRoot.appendChild(e),this.shadowRoot.appendChild(this.mountPoint)}this.renderApp()}disconnectedCallback(){console.log("FastSearchCard disconnected"),this.mountPoint&&H(null,this.mountPoint),fn.getState().reset()}setConfig(e){if(console.log("Config received:",e),!e)throw new Error("Invalid configuration");this._config=e,fn.getState().setConfig(e),this.isConnected&&this.renderApp()}set hass(e){this._hass=e,fn.getState().setHass(e),this.isConnected&&this.mountPoint&&this.renderApp()}get hass(){return this._hass}renderApp(){this.mountPoint&&H(Q(dr,{hass:this._hass,config:this._config,onAction:this.handleAction,shadowRoot:this.shadowRoot}),this.mountPoint)}async handleAction(e){if(console.log("Action:",e),!this._hass)return console.error("Hass not available"),void fn.getState().setActionFeedback({type:"error",message:"Home Assistant not connected"});try{switch(e.type){case"CALL_SERVICE":await this._hass.callService(e.domain,e.service,e.data);break;case"TOGGLE":await this._hass.callService("homeassistant","toggle",{entity_id:e.entityId});break;case"TURN_ON":await this._hass.callService("homeassistant","turn_on",{entity_id:e.entityId,...e.data});break;case"TURN_OFF":await this._hass.callService("homeassistant","turn_off",{entity_id:e.entityId});break;case"SET_VALUE":await this._hass.callService(e.domain,e.service,{entity_id:e.entityId,...e.data});break;case"FIRE_EVENT":const t=new CustomEvent(e.event,{detail:e.data,bubbles:!0,composed:!0});this.dispatchEvent(t);break;case"NAVIGATE":e.path&&(window.history.pushState(null,"",e.path),window.dispatchEvent(new Event("location-changed")));break;case"MORE_INFO":const n=new CustomEvent("hass-more-info",{detail:{entityId:e.entityId},bubbles:!0,composed:!0});this.dispatchEvent(n);break;default:return void console.warn("Unknown action type:",e.type)}fn.getState().setActionFeedback({type:"success",message:"Action completed"})}catch(t){console.error("Action failed:",t),fn.getState().setActionFeedback({type:"error",message:t.message||"Action failed"})}}static getConfigElement(){return document.createElement("div")}static getStubConfig(){return{type:"custom:fast-search-card",title:"Search",show_favorites:!0,domains:["light","switch","climate","cover","media_player"],max_results:50,animations:!0,default_view:"grid",theme:"auto"}}getCardSize(){var e;const t=fn.getState().viewMode,n=fn.getState().getDevices().length;return"compact"===t?Math.max(3,Math.ceil(n/3)):"list"===t?Math.max(3,Math.ceil(n/2)):(null==(e=this._config)?void 0:e.card_height)||4}}customElements.get("fast-search-card")||customElements.define("fast-search-card",hr),window.customCards=window.customCards||[],window.customCards.find(e=>"fast-search-card"===e.type)||window.customCards.push({type:"fast-search-card",name:"Fast Search Card",preview:!0,description:"A modern, fast search card for Home Assistant with Preact"}),console.info("%c FAST-SEARCH-CARD v2.0 %c Loaded with Preact ","color: white; background: #007AFF; font-weight: bold;","color: white; background: #27AE60; font-weight: bold;")}();
